<section class="dashboards">
    <div class="sidebar">
        <h1>WelDup</h1>
        <h2>Dashboard</h2>
        <nav class="sidebar-nav">
            <a (click)="changeTab('dashboard')">Dashboard</a>
            <a (click)="changeTab('products')">Products</a>
            <a (click)="changeTab('orders')">Orders</a>
            <a (click)="changeTab('profile')">Profile</a>
            <a (click)="changeTab('analytics')">Analytics</a>
            <a href="#" style="margin-top: 150px;">Log Out</a>
        </nav>
    </div>

    <div class="main-content">
        <h3>Hello Company!!!</h3>
        <span (click)="changeTab('profile')"
            style="font-size: 70px; position: absolute; top: 25px; right: 35px; cursor: pointer;">
            <mat-icon>group</mat-icon>
        </span>
        @if (currentPage == 'dashboard') {
        <div class="dashboard-grid">
            @for (item of items; track $index) {
            <div class="dashboard-card">
                <h4>{{item.header}}</h4>
                <h4>{{item.numbers}}</h4>
            </div>
            }

            <div class="dashboard-card sales-chart recent-orders">
                <h3>Items Available</h3>
                <div style="height: fit-content; background-color: #ecf0f1;">
<table class="product-table">
                        <thead>
                            <tr>
                                <th>Item Name</th>
                                <th>Amount</th>
                                <th>Company Name</th>
                                <th>City</th>
                                <th>Address</th>
                                <th>Image</th>
                                <th>Delete Item</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (product of products; track product._id) {
                            <tr>
                                <td>{{ product.itemName }}</td>
                                <td>{{ product.amount }}</td>
                                <td>{{ product.companyName }}</td>
                                <td>{{ product.city }}</td>
                                <td>{{ product.address }}</td>
                                <td>
                                    <img [src]="product.productImage" 
                                          alt="{{ product.itemName }}"
                                           style="width: 50px; height: 50px; object-fit: cover;"
                                           *ngIf="product.productImage">
                                <span *ngIf="!product.productImage">No image</span>
                                </td>
                                <td>
                                    <button mat-icon-button color="warn">
                                        <mat-icon (click)="deleteProduct(product)">delete</mat-icon>
                                    </button>
                                </td>
                            </tr>
                            } @empty {
                            <tr>
                                <td colspan="7" class="no-products">No products found</td>
                            </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>



        </div>

        }

        @if (currentPage == 'orders') {
        <div class="dashboard-card recent-orders">
            <h3>Recent Orders</h3>
            <table>
                <thead>
                    <tr>
                        <th>Item Name</th>
                        <th>Amount</th>
                        <th>Company Names</th>
                        <th>Country</th>
                        <th>City</th>
                        <th>status</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- @for (item of orders; track $index) {
                    <tr>
                        <td>{{ item.itemName }}</td>
                        <td>{{ item.amount }}</td>
                        <td>{{ item.companyName }}</td>
                        <td>{{ item.country }}</td>
                        <td>{{ item.city }}</td>
                        <td>{{ item.status }}</td>
                    </tr>
                    } -->

                </tbody>
            </table>
        </div>
        }

        @if (currentPage == 'profile') {
        <h3>Manage Your Account</h3>
        <button class="profileview" (click)="profileChangeTab('profileview')">Profile</button>
        <button class="profileform" (click)="profileChangeTab('profileform')">Update</button>
        <div class="profile">
            @if ( profilePage == 'profileview') {
            <div class="profileview">
                <img [src]="imgurl" alt="">
                <div class="profile-text">
                    <h4>Name: <span style="font-weight: 600;">{{username}}</span></h4>
                    <h4>Email: <span style="font-weight: 600;">{{email}}</span></h4>
                    <h4>Number: <span style="font-weight: 600;">{{number}}</span></h4>
                    <h4>Country: <span style="font-weight: 600;">{{country}}</span></h4>
                    <h4>City: <span style="font-weight: 600;">{{city}}</span></h4>
                </div>
            </div>
            }
            @if (profilePage == 'profileform') {
            <div class="profileform">
                <h2>Fill the Form Below</h2>
                <label for="">Full Name <br><input type="text" [(ngModel)]="username"></label><br>
                <label for="">Email Address <br> <input type="email" name="" id="" [(ngModel)]="email"></label><br>
                <label for="">Phone Number <br> <input type="text" name="" id="" [(ngModel)]="number"></label><br>
                <label for="">Country <br><input type="text" name="" id="" [(ngModel)]="country"></label><br>
                <label for="">City <br> <input type="text" name="" id="" [(ngModel)]="city"></label><br>

                <button>submit</button>
            </div>
            }
        </div>
        }
        @if (currentPage == 'analytics') {

        <h1>graphs </h1>
        }

        @if (currentPage == 'products') {
        <h3>Products and Uploads </h3>
        <button class="profileview" (click)="productChangeTab('productList')">List Of Products</button>
        <button class="profileform" (click)="productChangeTab('uploadProducts')">Create Products</button>

        <div class="profile">

            @if ( productPage == 'productList') {
            <div class="list-products">
                <h3>Registered Products</h3>
                <div style="height: fit-content; background-color: #ecf0f1">
                    <table class="product-table">
                        <thead>
                            <tr>
                                <th>Item Name</th>
                                <th>Amount</th>
                                <th>Company Name</th>
                                <th>City</th>
                                <th>Address</th>
                                <th>Image</th>
                                <th>Delete Item</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (product of products; track product._id) {
                            <tr>
                                <td>{{ product.itemName }}</td>
                                <td>{{ product.amount }}</td>
                                <td>{{ product.companyName }}</td>
                                <td>{{ product.city }}</td>
                                <td>{{ product.address }}</td>
                                <td>
                                    <img [src]="product.productImage" alt="{{ product.itemName }}"
                                        style="width: 50px; height: 50px; object-fit: cover;"
                                        *ngIf="product.productImage">
                                    <span *ngIf="!product.productImage">No image</span>
                                </td>
                                <td>
                                    <button mat-icon-button color="warn">
                                        <mat-icon (click)="deleteProduct(product)">delete</mat-icon>
                                    </button>
                                </td>
                            </tr>
                            } @empty {
                            <tr>
                                <td colspan="7" class="no-products">No products found</td>
                            </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            }

            @if ( productPage == 'uploadProducts') {


            <form [formGroup]="createProductForm">
                <p>Fill in the following information</p>
                <div>
                    <input formControlName="itemName" type="text" placeholder="Item Name" required />
                    <span
                        *ngIf="createProductForm.hasError('required', 'itemName') && createProductForm.controls['itemName'].dirty">*Item
                        nameis required</span>
                </div>
                <div>
                    <input formControlName="amount" type="number" placeholder="Item Price" required />
                    <span
                        *ngIf="createProductForm.hasError('required', 'amount') && createProductForm.controls['amount'].dirty">*Item
                        price is required</span>
                </div>
                <div>
                    <input formControlName="companyName" type="text" placeholder="Company Name" required />
                    <span
                        *ngIf="createProductForm.hasError('required', 'companyName') && createProductForm.controls['companyName'].dirty">*company
                        Name is required</span>
                </div>
                <div>
                    <input formControlName="city" type="text" placeholder="Your City" required />
                    <span
                        *ngIf="createProductForm.hasError('required', 'city') && createProductForm.controls['city'].dirty">*City
                        is required</span>
                </div>
                <div>
                    <input formControlName="address" type="text" placeholder="Your Addresse" required />
                    <span
                        *ngIf="createProductForm.hasError('required', 'address') && createProductForm.controls['address'].dirty">*address
                        is required</span>
                </div>
                <div>
                    <input formControlName="productImage" type="file" placeholder="Item image" required />
                    <span
                        *ngIf="createProductForm.hasError('required', 'productImage') && createProductForm.controls['productImage'].dirty">*product
                        Image is required</span>
                </div>

                <button [disabled]="createProductForm.invalid" [class.disabled]="createProductForm.invalid"
                    (click)="createProducts()" (click)="confirm()">Submit</button>
            </form>

            }
        </div>
        }
    </div>
</section>